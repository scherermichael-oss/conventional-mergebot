service: conventional-mergebot

plugins:
  - serverless-offline

provider:
  name: aws
  logRetentionInDays: 1
  runtime: nodejs12.x
  stackTags:
    Business Unit: COM
  stage: ${opt:stage, 'dev'}
  # Set to maximum timeout for API Gateway functions
  timeout: 60
  memorySize: ${file(config/config.${self:provider.stage}.json):memorySize}

functions:
  probot:
    handler: handler.probot

    environment:
      WEBHOOK_SECRET: ${file(config/config.${self:provider.stage}.json):WEBHOOK_SECRET}
      APP_ID: ${file(config/config.${self:provider.stage}.json):APP_ID}
      PRIVATE_KEY_PATH: keys/private-key.${self:provider.stage}.pem
    events:
      - http:
          path: /
          method: post
